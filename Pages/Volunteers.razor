@page "/volunteers"
@using Karma.Models
@using Karma.Data
@inject IFileContentProvider m_fileContentProvider
@inject NavigationManager m_uriHelper

<h1>Volunteers</h1>

<p>Here you can find the list of volunteers working on various projects.</p>

<table class="table">
    <tbody>
        <tr>
            <th>Name</th>
            <th>Surname</th>
            <th>Events</th>
        </tr>
        @foreach (VolunteerUser volunteer in GetVolunteers().Result)
        {
            <tr>
                <td>@volunteer.Name</td>
                <td>@volunteer.Surname</td>
                @if (volunteer.ParticipatedEvents != null)
                {
                    <td>
                        @foreach (CharityEvent charityEvent in volunteer.ParticipatedEvents)
                        {
                            <div @onclick="()=>NavigateToIndividualEvent(charityEvent.Id)">
                                @charityEvent.Name
                            </div>
                        }
                    </td>
                }
                else
                {
                    <td>No Data</td>
                }
            </tr>
        }
    </tbody>
</table>

@code {
    public async Task<IEnumerable<IVolunteerUser>> GetVolunteers()
    {
        return await m_fileContentProvider.ReadVolunteerFromFileAsync();
    }

    public void NavigateToIndividualEvent(Guid id)
    {
        m_uriHelper.NavigateTo($"event/{id}");
    }
}
